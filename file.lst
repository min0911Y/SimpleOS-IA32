     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 [FILE "file.c"]
     7                                          [SECTION .data]
     8 00000000                                 _keytable:
     9 00000000 00                              	DB	0
    10 00000001 00                              	DB	0
    11 00000002 21                              	DB	33
    12 00000003 40                              	DB	64
    13 00000004 23                              	DB	35
    14 00000005 24                              	DB	36
    15 00000006 25                              	DB	37
    16 00000007 5E                              	DB	94
    17 00000008 26                              	DB	38
    18 00000009 2A                              	DB	42
    19 0000000A 28                              	DB	40
    20 0000000B 29                              	DB	41
    21 0000000C 5F                              	DB	95
    22 0000000D 2B                              	DB	43
    23 0000000E 08                              	DB	8
    24 0000000F 00                              	DB	0
    25 00000010 51                              	DB	81
    26 00000011 57                              	DB	87
    27 00000012 45                              	DB	69
    28 00000013 52                              	DB	82
    29 00000014 54                              	DB	84
    30 00000015 59                              	DB	89
    31 00000016 55                              	DB	85
    32 00000017 49                              	DB	73
    33 00000018 4F                              	DB	79
    34 00000019 50                              	DB	80
    35 0000001A 7B                              	DB	123
    36 0000001B 7D                              	DB	125
    37 0000001C 0A                              	DB	10
    38 0000001D 00                              	DB	0
    39 0000001E 41                              	DB	65
    40 0000001F 53                              	DB	83
    41 00000020 44                              	DB	68
    42 00000021 46                              	DB	70
    43 00000022 47                              	DB	71
    44 00000023 48                              	DB	72
    45 00000024 4A                              	DB	74
    46 00000025 4B                              	DB	75
    47 00000026 4C                              	DB	76
    48 00000027 3A                              	DB	58
    49 00000028 22                              	DB	34
    50 00000029 00                              	DB	0
    51 0000002A 00                              	DB	0
    52 0000002B 7C                              	DB	124
    53 0000002C 5A                              	DB	90
    54 0000002D 58                              	DB	88
    55 0000002E 43                              	DB	67
    56 0000002F 56                              	DB	86
    57 00000030 42                              	DB	66
    58 00000031 4E                              	DB	78
    59 00000032 4D                              	DB	77
    60 00000033 3C                              	DB	60
    61 00000034 3E                              	DB	62
    62 00000035 3F                              	DB	63
    63 00000036 00                              	DB	0
    64 00000037 2A                              	DB	42
    65 00000038 00                              	DB	0
    66 00000039 20                              	DB	32
    67 0000003A 61                              	DB	97
    68 0000003B 00                              	DB	0
    69 0000003C 00                              	DB	0
    70 0000003D 00                              	DB	0
    71 0000003E 00                              	DB	0
    72 0000003F 00                              	DB	0
    73 00000040 00                              	DB	0
    74 00000041 00                              	DB	0
    75 00000042 00                              	DB	0
    76 00000043 00                              	DB	0
    77 00000044 00                              	DB	0
    78 00000045 00                              	DB	0
    79 00000046 00                              	DB	0
    80 00000047 37                              	DB	55
    81 00000048 38                              	DB	56
    82 00000049 39                              	DB	57
    83 0000004A 2D                              	DB	45
    84 0000004B 34                              	DB	52
    85 0000004C 35                              	DB	53
    86 0000004D 36                              	DB	54
    87 0000004E 2B                              	DB	43
    88 0000004F 31                              	DB	49
    89 00000050 32                              	DB	50
    90 00000051 33                              	DB	51
    91 00000052 30                              	DB	48
    92 00000053 2E                              	DB	46
    93 00000054                                 _keytable1:
    94 00000054 00                              	DB	0
    95 00000055 00                              	DB	0
    96 00000056 31                              	DB	49
    97 00000057 32                              	DB	50
    98 00000058 33                              	DB	51
    99 00000059 34                              	DB	52
   100 0000005A 35                              	DB	53
   101 0000005B 36                              	DB	54
   102 0000005C 37                              	DB	55
   103 0000005D 38                              	DB	56
   104 0000005E 39                              	DB	57
   105 0000005F 30                              	DB	48
   106 00000060 2D                              	DB	45
   107 00000061 3D                              	DB	61
   108 00000062 08                              	DB	8
   109 00000063 00                              	DB	0
   110 00000064 71                              	DB	113
   111 00000065 77                              	DB	119
   112 00000066 65                              	DB	101
   113 00000067 72                              	DB	114
   114 00000068 74                              	DB	116
   115 00000069 79                              	DB	121
   116 0000006A 75                              	DB	117
   117 0000006B 69                              	DB	105
   118 0000006C 6F                              	DB	111
   119 0000006D 70                              	DB	112
   120 0000006E 5B                              	DB	91
   121 0000006F 5D                              	DB	93
   122 00000070 0A                              	DB	10
   123 00000071 00                              	DB	0
   124 00000072 61                              	DB	97
   125 00000073 73                              	DB	115
   126 00000074 64                              	DB	100
   127 00000075 66                              	DB	102
   128 00000076 67                              	DB	103
   129 00000077 68                              	DB	104
   130 00000078 6A                              	DB	106
   131 00000079 6B                              	DB	107
   132 0000007A 6C                              	DB	108
   133 0000007B 3B                              	DB	59
   134 0000007C 27                              	DB	39
   135 0000007D 00                              	DB	0
   136 0000007E 00                              	DB	0
   137 0000007F 5C                              	DB	92
   138 00000080 7A                              	DB	122
   139 00000081 78                              	DB	120
   140 00000082 63                              	DB	99
   141 00000083 76                              	DB	118
   142 00000084 62                              	DB	98
   143 00000085 6E                              	DB	110
   144 00000086 6D                              	DB	109
   145 00000087 2C                              	DB	44
   146 00000088 2E                              	DB	46
   147 00000089 2F                              	DB	47
   148 0000008A 00                              	DB	0
   149 0000008B 2A                              	DB	42
   150 0000008C 00                              	DB	0
   151 0000008D 20                              	DB	32
   152 0000008E 46                              	DB	70
   153 0000008F 00                              	DB	0
   154 00000090 00                              	DB	0
   155 00000091 00                              	DB	0
   156 00000092 00                              	DB	0
   157 00000093 00                              	DB	0
   158 00000094 00                              	DB	0
   159 00000095 00                              	DB	0
   160 00000096 00                              	DB	0
   161 00000097 00                              	DB	0
   162 00000098 00                              	DB	0
   163 00000099 00                              	DB	0
   164 0000009A 00                              	DB	0
   165 0000009B 37                              	DB	55
   166 0000009C 38                              	DB	56
   167 0000009D 39                              	DB	57
   168 0000009E 2D                              	DB	45
   169 0000009F 34                              	DB	52
   170 000000A0 35                              	DB	53
   171 000000A1 36                              	DB	54
   172 000000A2 2B                              	DB	43
   173 000000A3 31                              	DB	49
   174 000000A4 32                              	DB	50
   175 000000A5 33                              	DB	51
   176 000000A6 30                              	DB	48
   177 000000A7 2E                              	DB	46
   178                                          [SECTION .text]
   179 00000000                                 	GLOBAL	_file_readfat
   180 00000000                                 _file_readfat:
   181 00000000 55                              	PUSH	EBP
   182 00000001 31 C9                           	XOR	ECX,ECX
   183 00000003 89 E5                           	MOV	EBP,ESP
   184 00000005 57                              	PUSH	EDI
   185 00000006 56                              	PUSH	ESI
   186 00000007 53                              	PUSH	EBX
   187 00000008 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   188 0000000B 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   189 0000000E 31 DB                           	XOR	EBX,EBX
   190 00000010                                 L6:
   191 00000010 0F B6 44 31 01                  	MOVZX	EAX,BYTE [1+ECX+ESI*1]
   192 00000015 0F B6 14 31                     	MOVZX	EDX,BYTE [ECX+ESI*1]
   193 00000019 C1 E0 08                        	SAL	EAX,8
   194 0000001C 09 C2                           	OR	EDX,EAX
   195 0000001E 81 E2 00000FFF                  	AND	EDX,4095
   196 00000024 89 14 9F                        	MOV	DWORD [EDI+EBX*4],EDX
   197 00000027 8A 44 31 01                     	MOV	AL,BYTE [1+ECX+ESI*1]
   198 0000002B 0F B6 54 31 02                  	MOVZX	EDX,BYTE [2+ECX+ESI*1]
   199 00000030 C0 E8 04                        	SHR	AL,4
   200 00000033 83 C1 03                        	ADD	ECX,3
   201 00000036 C1 E2 04                        	SAL	EDX,4
   202 00000039 0F B6 C0                        	MOVZX	EAX,AL
   203 0000003C 09 D0                           	OR	EAX,EDX
   204 0000003E 89 44 9F 04                     	MOV	DWORD [4+EDI+EBX*4],EAX
   205 00000042 83 C3 02                        	ADD	EBX,2
   206 00000045 81 FB 00000B3F                  	CMP	EBX,2879
   207 0000004B 7E C3                           	JLE	L6
   208 0000004D 5B                              	POP	EBX
   209 0000004E 5E                              	POP	ESI
   210 0000004F 5F                              	POP	EDI
   211 00000050 5D                              	POP	EBP
   212 00000051 C3                              	RET
   213 00000052                                 	GLOBAL	_file_loadfile
   214 00000052                                 _file_loadfile:
   215 00000052 55                              	PUSH	EBP
   216 00000053 89 E5                           	MOV	EBP,ESP
   217 00000055 57                              	PUSH	EDI
   218 00000056 56                              	PUSH	ESI
   219 00000057 53                              	PUSH	EBX
   220 00000058 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   221 0000005B 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   222 0000005E 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   223 00000061                                 L10:
   224 00000061 81 F9 00000200                  	CMP	ECX,512
   225 00000067 7E 2F                           	JLE	L27
   226 00000069 31 D2                           	XOR	EDX,EDX
   227 0000006B                                 L23:
   228 0000006B 89 F0                           	MOV	EAX,ESI
   229 0000006D 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   230 00000070 C1 E0 09                        	SAL	EAX,9
   231 00000073 01 D0                           	ADD	EAX,EDX
   232 00000075 8A 04 38                        	MOV	AL,BYTE [EAX+EDI*1]
   233 00000078 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   234 0000007B 42                              	INC	EDX
   235 0000007C 81 FA 000001FF                  	CMP	EDX,511
   236 00000082 7E E7                           	JLE	L23
   237 00000084 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   238 00000087 81 E9 00000200                  	SUB	ECX,512
   239 0000008D 81 C3 00000200                  	ADD	EBX,512
   240 00000093 8B 34 B0                        	MOV	ESI,DWORD [EAX+ESI*4]
   241 00000096 EB C9                           	JMP	L10
   242 00000098                                 L27:
   243 00000098 31 D2                           	XOR	EDX,EDX
   244 0000009A 39 CA                           	CMP	EDX,ECX
   245 0000009C 7D 15                           	JGE	L9
   246 0000009E                                 L18:
   247 0000009E 89 F0                           	MOV	EAX,ESI
   248 000000A0 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   249 000000A3 C1 E0 09                        	SAL	EAX,9
   250 000000A6 01 D0                           	ADD	EAX,EDX
   251 000000A8 8A 04 38                        	MOV	AL,BYTE [EAX+EDI*1]
   252 000000AB 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   253 000000AE 42                              	INC	EDX
   254 000000AF 39 CA                           	CMP	EDX,ECX
   255 000000B1 7C EB                           	JL	L18
   256 000000B3                                 L9:
   257 000000B3 5B                              	POP	EBX
   258 000000B4 5E                              	POP	ESI
   259 000000B5 5F                              	POP	EDI
   260 000000B6 5D                              	POP	EBP
   261 000000B7 C3                              	RET
   262 000000B8                                 	GLOBAL	_file_search
   263 000000B8                                 _file_search:
   264 000000B8 55                              	PUSH	EBP
   265 000000B9 31 C9                           	XOR	ECX,ECX
   266 000000BB 89 E5                           	MOV	EBP,ESP
   267 000000BD 57                              	PUSH	EDI
   268 000000BE 56                              	PUSH	ESI
   269 000000BF 53                              	PUSH	EBX
   270 000000C0 83 EC 14                        	SUB	ESP,20
   271 000000C3 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   272 000000C6                                 L33:
   273 000000C6 C6 44 0D E4 20                  	MOV	BYTE [-28+EBP+ECX*1],32
   274 000000CB 41                              	INC	ECX
   275 000000CC 83 F9 0A                        	CMP	ECX,10
   276 000000CF 7E F5                           	JLE	L33
   277 000000D1 31 C9                           	XOR	ECX,ECX
   278 000000D3 31 FF                           	XOR	EDI,EDI
   279 000000D5 80 3B 00                        	CMP	BYTE [EBX],0
   280 000000D8 74 29                           	JE	L60
   281 000000DA                                 L42:
   282 000000DA 31 C0                           	XOR	EAX,EAX
   283 000000DC 83 F9 0A                        	CMP	ECX,10
   284 000000DF 7F 5B                           	JG	L28
   285 000000E1 8A 14 1F                        	MOV	DL,BYTE [EDI+EBX*1]
   286 000000E4 80 FA 2E                        	CMP	DL,46
   287 000000E7 74 6C                           	JE	L64
   288 000000E9                                 L39:
   289 000000E9 8D 42 9F                        	LEA	EAX,DWORD [-97+EDX]
   290 000000EC 88 54 0D E4                     	MOV	BYTE [-28+EBP+ECX*1],DL
   291 000000F0 3C 19                           	CMP	AL,25
   292 000000F2 77 07                           	JA	L41
   293 000000F4 8D 42 E0                        	LEA	EAX,DWORD [-32+EDX]
   294 000000F7 88 44 0D E4                     	MOV	BYTE [-28+EBP+ECX*1],AL
   295 000000FB                                 L41:
   296 000000FB 41                              	INC	ECX
   297 000000FC                                 L36:
   298 000000FC 47                              	INC	EDI
   299 000000FD 80 3C 1F 00                     	CMP	BYTE [EDI+EBX*1],0
   300 00000101 75 D7                           	JNE	L42
   301 00000103                                 L60:
   302 00000103 31 FF                           	XOR	EDI,EDI
   303 00000105 3B 7D 10                        	CMP	EDI,DWORD [16+EBP]
   304 00000108 7D 47                           	JGE	L44
   305 0000010A 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   306 0000010D C7 45 E0 00000000               	MOV	DWORD [-32+EBP],0
   307 00000114                                 L56:
   308 00000114 80 3E 00                        	CMP	BYTE [ESI],0
   309 00000117 74 38                           	JE	L44
   310 00000119 F6 46 0B 18                     	TEST	BYTE [11+ESI],24
   311 0000011D 75 25                           	JNE	L54
   312 0000011F 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   313 00000122 31 C9                           	XOR	ECX,ECX
   314 00000124 03 5D E0                        	ADD	EBX,DWORD [-32+EBP]
   315 00000127                                 L55:
   316 00000127 0F B6 13                        	MOVZX	EDX,BYTE [EBX]
   317 0000012A 0F BE 44 0D E4                  	MOVSX	EAX,BYTE [-28+EBP+ECX*1]
   318 0000012F 39 C2                           	CMP	EDX,EAX
   319 00000131 75 11                           	JNE	L54
   320 00000133 41                              	INC	ECX
   321 00000134 43                              	INC	EBX
   322 00000135 89 F0                           	MOV	EAX,ESI
   323 00000137 83 F9 0A                        	CMP	ECX,10
   324 0000013A 7E EB                           	JLE	L55
   325 0000013C                                 L28:
   326 0000013C 83 C4 14                        	ADD	ESP,20
   327 0000013F 5B                              	POP	EBX
   328 00000140 5E                              	POP	ESI
   329 00000141 5F                              	POP	EDI
   330 00000142 5D                              	POP	EBP
   331 00000143 C3                              	RET
   332 00000144                                 L54:
   333 00000144 47                              	INC	EDI
   334 00000145 83 C6 20                        	ADD	ESI,32
   335 00000148 83 45 E0 20                     	ADD	DWORD [-32+EBP],32
   336 0000014C 3B 7D 10                        	CMP	EDI,DWORD [16+EBP]
   337 0000014F 7C C3                           	JL	L56
   338 00000151                                 L44:
   339 00000151 31 C0                           	XOR	EAX,EAX
   340 00000153 EB E7                           	JMP	L28
   341 00000155                                 L64:
   342 00000155 83 F9 08                        	CMP	ECX,8
   343 00000158 7F 8F                           	JG	L39
   344 0000015A B9 00000008                     	MOV	ECX,8
   345 0000015F EB 9B                           	JMP	L36
