     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_print
     8 00000000                                 	EXTERN	_print_32bit_hex
     9 00000000                                 	EXTERN	_getch
    10 00000000                                 	EXTERN	_printchar
    11 00000000                                 	EXTERN	_memman_free_4k
    12 00000000                                 	EXTERN	_set_segmdesc
    13 00000000                                 	EXTERN	_farcall
    14 00000000                                 	EXTERN	_strtol
    15 00000000                                 [FILE "macinecode.c"]
    16                                          [SECTION .data]
    17 00000000                                 _keytable:
    18 00000000 00                              	DB	0
    19 00000001 00                              	DB	0
    20 00000002 21                              	DB	33
    21 00000003 40                              	DB	64
    22 00000004 23                              	DB	35
    23 00000005 24                              	DB	36
    24 00000006 25                              	DB	37
    25 00000007 5E                              	DB	94
    26 00000008 26                              	DB	38
    27 00000009 2A                              	DB	42
    28 0000000A 28                              	DB	40
    29 0000000B 29                              	DB	41
    30 0000000C 5F                              	DB	95
    31 0000000D 2B                              	DB	43
    32 0000000E 08                              	DB	8
    33 0000000F 00                              	DB	0
    34 00000010 51                              	DB	81
    35 00000011 57                              	DB	87
    36 00000012 45                              	DB	69
    37 00000013 52                              	DB	82
    38 00000014 54                              	DB	84
    39 00000015 59                              	DB	89
    40 00000016 55                              	DB	85
    41 00000017 49                              	DB	73
    42 00000018 4F                              	DB	79
    43 00000019 50                              	DB	80
    44 0000001A 7B                              	DB	123
    45 0000001B 7D                              	DB	125
    46 0000001C 0A                              	DB	10
    47 0000001D 00                              	DB	0
    48 0000001E 41                              	DB	65
    49 0000001F 53                              	DB	83
    50 00000020 44                              	DB	68
    51 00000021 46                              	DB	70
    52 00000022 47                              	DB	71
    53 00000023 48                              	DB	72
    54 00000024 4A                              	DB	74
    55 00000025 4B                              	DB	75
    56 00000026 4C                              	DB	76
    57 00000027 3A                              	DB	58
    58 00000028 22                              	DB	34
    59 00000029 00                              	DB	0
    60 0000002A 00                              	DB	0
    61 0000002B 7C                              	DB	124
    62 0000002C 5A                              	DB	90
    63 0000002D 58                              	DB	88
    64 0000002E 43                              	DB	67
    65 0000002F 56                              	DB	86
    66 00000030 42                              	DB	66
    67 00000031 4E                              	DB	78
    68 00000032 4D                              	DB	77
    69 00000033 3C                              	DB	60
    70 00000034 3E                              	DB	62
    71 00000035 3F                              	DB	63
    72 00000036 00                              	DB	0
    73 00000037 2A                              	DB	42
    74 00000038 00                              	DB	0
    75 00000039 20                              	DB	32
    76 0000003A 61                              	DB	97
    77 0000003B 00                              	DB	0
    78 0000003C 00                              	DB	0
    79 0000003D 00                              	DB	0
    80 0000003E 00                              	DB	0
    81 0000003F 00                              	DB	0
    82 00000040 00                              	DB	0
    83 00000041 00                              	DB	0
    84 00000042 00                              	DB	0
    85 00000043 00                              	DB	0
    86 00000044 00                              	DB	0
    87 00000045 00                              	DB	0
    88 00000046 00                              	DB	0
    89 00000047 37                              	DB	55
    90 00000048 38                              	DB	56
    91 00000049 39                              	DB	57
    92 0000004A 2D                              	DB	45
    93 0000004B 34                              	DB	52
    94 0000004C 35                              	DB	53
    95 0000004D 36                              	DB	54
    96 0000004E 2B                              	DB	43
    97 0000004F 31                              	DB	49
    98 00000050 32                              	DB	50
    99 00000051 33                              	DB	51
   100 00000052 30                              	DB	48
   101 00000053 2E                              	DB	46
   102 00000054                                 _keytable1:
   103 00000054 00                              	DB	0
   104 00000055 00                              	DB	0
   105 00000056 31                              	DB	49
   106 00000057 32                              	DB	50
   107 00000058 33                              	DB	51
   108 00000059 34                              	DB	52
   109 0000005A 35                              	DB	53
   110 0000005B 36                              	DB	54
   111 0000005C 37                              	DB	55
   112 0000005D 38                              	DB	56
   113 0000005E 39                              	DB	57
   114 0000005F 30                              	DB	48
   115 00000060 2D                              	DB	45
   116 00000061 3D                              	DB	61
   117 00000062 08                              	DB	8
   118 00000063 00                              	DB	0
   119 00000064 71                              	DB	113
   120 00000065 77                              	DB	119
   121 00000066 65                              	DB	101
   122 00000067 72                              	DB	114
   123 00000068 74                              	DB	116
   124 00000069 79                              	DB	121
   125 0000006A 75                              	DB	117
   126 0000006B 69                              	DB	105
   127 0000006C 6F                              	DB	111
   128 0000006D 70                              	DB	112
   129 0000006E 5B                              	DB	91
   130 0000006F 5D                              	DB	93
   131 00000070 0A                              	DB	10
   132 00000071 00                              	DB	0
   133 00000072 61                              	DB	97
   134 00000073 73                              	DB	115
   135 00000074 64                              	DB	100
   136 00000075 66                              	DB	102
   137 00000076 67                              	DB	103
   138 00000077 68                              	DB	104
   139 00000078 6A                              	DB	106
   140 00000079 6B                              	DB	107
   141 0000007A 6C                              	DB	108
   142 0000007B 3B                              	DB	59
   143 0000007C 27                              	DB	39
   144 0000007D 00                              	DB	0
   145 0000007E 00                              	DB	0
   146 0000007F 5C                              	DB	92
   147 00000080 7A                              	DB	122
   148 00000081 78                              	DB	120
   149 00000082 63                              	DB	99
   150 00000083 76                              	DB	118
   151 00000084 62                              	DB	98
   152 00000085 6E                              	DB	110
   153 00000086 6D                              	DB	109
   154 00000087 2C                              	DB	44
   155 00000088 2E                              	DB	46
   156 00000089 2F                              	DB	47
   157 0000008A 00                              	DB	0
   158 0000008B 2A                              	DB	42
   159 0000008C 00                              	DB	0
   160 0000008D 20                              	DB	32
   161 0000008E 46                              	DB	70
   162 0000008F 00                              	DB	0
   163 00000090 00                              	DB	0
   164 00000091 00                              	DB	0
   165 00000092 00                              	DB	0
   166 00000093 00                              	DB	0
   167 00000094 00                              	DB	0
   168 00000095 00                              	DB	0
   169 00000096 00                              	DB	0
   170 00000097 00                              	DB	0
   171 00000098 00                              	DB	0
   172 00000099 00                              	DB	0
   173 0000009A 00                              	DB	0
   174 0000009B 37                              	DB	55
   175 0000009C 38                              	DB	56
   176 0000009D 39                              	DB	57
   177 0000009E 2D                              	DB	45
   178 0000009F 34                              	DB	52
   179 000000A0 35                              	DB	53
   180 000000A1 36                              	DB	54
   181 000000A2 2B                              	DB	43
   182 000000A3 31                              	DB	49
   183 000000A4 32                              	DB	50
   184 000000A5 33                              	DB	51
   185 000000A6 30                              	DB	48
   186 000000A7 2E                              	DB	46
   187 000000A8                                 LC0:
   188 000000A8 6D 65 6D 3D 00                  	DB	"mem=",0x00
   189 000000AD                                 LC1:
   190 000000AD 3A 30 0A 00                     	DB	":0",0x0A,0x00
   191 000000B1                                 LC2:
   192 000000B1 49 4E 50 55 54 20 43 4F 44 45   	DB	"INPUT CODE:",0x00
       000000BB 3A 00 
   193 000000BD                                 LC6:
   194 000000BD 20 00                           	DB	" ",0x00
   195 000000BF                                 LC4:
   196 000000BF 0A 00                           	DB	0x0A,0x00
   197 000000C1                                 LC7:
   198 000000C1 3E 00                           	DB	">",0x00
   199 000000C3                                 LC8:
   200 000000C3 72 00                           	DB	"r",0x00
   201 000000C5                                 LC12:
   202 000000C5 71 00                           	DB	"q",0x00
   203 000000C7                                 LC13:
   204 000000C7 73 00                           	DB	"s",0x00
   205 000000C9                                 LC14:
   206 000000C9 62 61 64 20 63 6F 6D 6D 61 6E   	DB	"bad command!!!!!!!!!",0x0A,0x00
       000000D3 64 21 21 21 21 21 21 21 21 21 
       000000DD 0A 00 
   207 000000DF                                 LC9:
   208 000000DF 4C 6F 61 64 69 6E 67 2E 2E 2E   	DB	"Loading...",0x0A,0x00
       000000E9 0A 00 
   209 000000EB                                 LC10:
   210 000000EB 4C 6F 61 64 65 64 21 0A 00      	DB	"Loaded!",0x0A,0x00
   211 000000F4                                 LC11:
   212 000000F4 70 72 6F 67 72 61 6D 20 65 6E   	DB	"program end",0x0A,0x00
       000000FE 64 0A 00 
   213 00000101                                 LC5:
   214 00000101 08 00                           	DB	0x08,0x00
   215 00000103                                 LC3:
   216 00000103 08 08 00                        	DB	0x08,0x08,0x00
   217                                          [SECTION .text]
   218 00000000                                 	GLOBAL	_macineMAIN
   219 00000000                                 _macineMAIN:
   220 00000000 55                              	PUSH	EBP
   221 00000001 89 E5                           	MOV	EBP,ESP
   222 00000003 57                              	PUSH	EDI
   223 00000004 56                              	PUSH	ESI
   224 00000005 53                              	PUSH	EBX
   225 00000006 81 EC 00000838                  	SUB	ESP,2104
   226 0000000C 68 00000200                     	PUSH	512
   227 00000011 68 003C0000                     	PUSH	3932160
   228 00000016 E8 [00000000]                   	CALL	_memman_alloc_4k
   229 0000001B A3 00000FE8                     	MOV	DWORD [4072],EAX
   230 00000020 68 [000000A8]                   	PUSH	LC0
   231 00000025 89 85 FFFFF7C0                  	MOV	DWORD [-2112+EBP],EAX
   232 0000002B E8 [00000000]                   	CALL	_print
   233 00000030 FF B5 FFFFF7C0                  	PUSH	DWORD [-2112+EBP]
   234 00000036 E8 [00000000]                   	CALL	_print_32bit_hex
   235 0000003B 68 [000000AD]                   	PUSH	LC1
   236 00000040 E8 [00000000]                   	CALL	_print
   237 00000045 83 C4 14                        	ADD	ESP,20
   238 00000048                                 L2:
   239 00000048 C7 85 FFFFF7BC 00000000         	MOV	DWORD [-2116+EBP],0
   240 00000052 68 [000000B1]                   	PUSH	LC2
   241 00000057                                 L46:
   242 00000057 E8 [00000000]                   	CALL	_print
   243 0000005C 58                              	POP	EAX
   244 0000005D                                 L6:
   245 0000005D E8 [00000000]                   	CALL	_getch
   246 00000062 3C 0A                           	CMP	AL,10
   247 00000064 88 45 E4                        	MOV	BYTE [-28+EBP],AL
   248 00000067 0F 84 00000091                  	JE	L18
   249 0000006D 3C 08                           	CMP	AL,8
   250 0000006F 0F 84 00000242                  	JE	L51
   251 00000075 3C 51                           	CMP	AL,81
   252 00000077 0F 84 00000126                  	JE	L45
   253 0000007D 3C 71                           	CMP	AL,113
   254 0000007F 0F 84 0000011E                  	JE	L45
   255 00000085 0F BE C0                        	MOVSX	EAX,AL
   256 00000088 50                              	PUSH	EAX
   257 00000089 E8 [00000000]                   	CALL	_printchar
   258 0000008E                                 L47:
   259 0000008E 58                              	POP	EAX
   260 0000008F                                 L10:
   261 0000008F E8 [00000000]                   	CALL	_getch
   262 00000094 3C 0A                           	CMP	AL,10
   263 00000096 88 45 E5                        	MOV	BYTE [-27+EBP],AL
   264 00000099 0F 84 000001EE                  	JE	L43
   265 0000009F 3C 08                           	CMP	AL,8
   266 000000A1 0F 84 000001CB                  	JE	L52
   267 000000A7 3C 51                           	CMP	AL,81
   268 000000A9 0F 84 000000F4                  	JE	L45
   269 000000AF 3C 71                           	CMP	AL,113
   270 000000B1 0F 84 000000EC                  	JE	L45
   271 000000B7 0F BE C0                        	MOVSX	EAX,AL
   272 000000BA 50                              	PUSH	EAX
   273 000000BB E8 [00000000]                   	CALL	_printchar
   274 000000C0 8D 45 E4                        	LEA	EAX,DWORD [-28+EBP]
   275 000000C3 50                              	PUSH	EAX
   276 000000C4 C6 45 E6 00                     	MOV	BYTE [-26+EBP],0
   277 000000C8 E8 0000021D                     	CALL	_HEX2INT
   278 000000CD 68 [000000BD]                   	PUSH	LC6
   279 000000D2 8B 95 FFFFF7BC                  	MOV	EDX,DWORD [-2116+EBP]
   280 000000D8 89 84 95 FFFFF7E4               	MOV	DWORD [-2076+EBP+EDX*4],EAX
   281 000000DF 42                              	INC	EDX
   282 000000E0 89 95 FFFFF7BC                  	MOV	DWORD [-2116+EBP],EDX
   283 000000E6 E8 [00000000]                   	CALL	_print
   284 000000EB 83 C4 0C                        	ADD	ESP,12
   285 000000EE 81 BD FFFFF7BC 000001FF         	CMP	DWORD [-2116+EBP],511
   286 000000F8 0F 8E FFFFFF5F                  	JLE	L6
   287 000000FE                                 L18:
   288 000000FE 68 [000000BF]                   	PUSH	LC4
   289 00000103 31 DB                           	XOR	EBX,EBX
   290 00000105 E8 [00000000]                   	CALL	_print
   291 0000010A 68 [000000C1]                   	PUSH	LC7
   292 0000010F E8 [00000000]                   	CALL	_print
   293 00000114 5F                              	POP	EDI
   294 00000115 58                              	POP	EAX
   295 00000116                                 L27:
   296 00000116 E8 [00000000]                   	CALL	_getch
   297 0000011B 3C 0A                           	CMP	AL,10
   298 0000011D 0F 84 00000142                  	JE	L44
   299 00000123 3C 08                           	CMP	AL,8
   300 00000125 0F 84 0000011A                  	JE	L53
   301 0000012B 88 84 1D FFFFF7C4               	MOV	BYTE [-2108+EBP+EBX*1],AL
   302 00000132 0F BE C0                        	MOVSX	EAX,AL
   303 00000135 50                              	PUSH	EAX
   304 00000136 E8 [00000000]                   	CALL	_printchar
   305 0000013B                                 L49:
   306 0000013B 5E                              	POP	ESI
   307 0000013C                                 L21:
   308 0000013C 43                              	INC	EBX
   309 0000013D 83 FB 1D                        	CMP	EBX,29
   310 00000140 7E D4                           	JLE	L27
   311 00000142                                 L20:
   312 00000142 68 [000000BF]                   	PUSH	LC4
   313 00000147 8D B5 FFFFF7C4                  	LEA	ESI,DWORD [-2108+EBP]
   314 0000014D BF [000000C3]                   	MOV	EDI,LC8
   315 00000152 E8 [00000000]                   	CALL	_print
   316 00000157 FC                              	CLD
   317 00000158 B9 00000002                     	MOV	ECX,2
   318 0000015D 5B                              	POP	EBX
   319 0000015E F3                              	REPE
   320 0000015F A6                              	CMPSB
   321 00000160 0F 97 C2                        	SETA	DL
   322 00000163 0F 92 C0                        	SETB	AL
   323 00000166 38 C2                           	CMP	DL,AL
   324 00000168 74 66                           	JE	L54
   325 0000016A FC                              	CLD
   326 0000016B 8D B5 FFFFF7C4                  	LEA	ESI,DWORD [-2108+EBP]
   327 00000171 BF [000000C5]                   	MOV	EDI,LC12
   328 00000176 B9 00000002                     	MOV	ECX,2
   329 0000017B F3                              	REPE
   330 0000017C A6                              	CMPSB
   331 0000017D 74 34                           	JE	L34
   332 0000017F 8D B5 FFFFF7C4                  	LEA	ESI,DWORD [-2108+EBP]
   333 00000185 BF [000000C7]                   	MOV	EDI,LC13
   334 0000018A B9 00000002                     	MOV	ECX,2
   335 0000018F F3                              	REPE
   336 00000190 A6                              	CMPSB
   337 00000191 74 10                           	JE	L45
   338 00000193 68 [000000C9]                   	PUSH	LC14
   339 00000198                                 L50:
   340 00000198 E8 [00000000]                   	CALL	_print
   341 0000019D                                 L48:
   342 0000019D 58                              	POP	EAX
   343 0000019E E9 FFFFFF5B                     	JMP	L18
   344 000001A3                                 L45:
   345 000001A3 68 [000000BF]                   	PUSH	LC4
   346 000001A8 E8 [00000000]                   	CALL	_print
   347 000001AD 5A                              	POP	EDX
   348 000001AE E9 FFFFFE95                     	JMP	L2
   349 000001B3                                 L34:
   350 000001B3 68 00000200                     	PUSH	512
   351 000001B8 FF B5 FFFFF7C0                  	PUSH	DWORD [-2112+EBP]
   352 000001BE 68 003C0000                     	PUSH	3932160
   353 000001C3 E8 [00000000]                   	CALL	_memman_free_4k
   354 000001C8 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   355 000001CB 5B                              	POP	EBX
   356 000001CC 5E                              	POP	ESI
   357 000001CD 5F                              	POP	EDI
   358 000001CE 5D                              	POP	EBP
   359 000001CF C3                              	RET
   360 000001D0                                 L54:
   361 000001D0 68 [000000DF]                   	PUSH	LC9
   362 000001D5 31 DB                           	XOR	EBX,EBX
   363 000001D7 E8 [00000000]                   	CALL	_print
   364 000001DC 3B 9D FFFFF7BC                  	CMP	EBX,DWORD [-2116+EBP]
   365 000001E2 59                              	POP	ECX
   366 000001E3 7D 19                           	JGE	L42
   367 000001E5                                 L33:
   368 000001E5 8B 95 FFFFF7C0                  	MOV	EDX,DWORD [-2112+EBP]
   369 000001EB 8A 84 9D FFFFF7E4               	MOV	AL,BYTE [-2076+EBP+EBX*4]
   370 000001F2 88 04 13                        	MOV	BYTE [EBX+EDX*1],AL
   371 000001F5 43                              	INC	EBX
   372 000001F6 3B 9D FFFFF7BC                  	CMP	EBX,DWORD [-2116+EBP]
   373 000001FC 7C E7                           	JL	L33
   374 000001FE                                 L42:
   375 000001FE 68 [000000EB]                   	PUSH	LC10
   376 00000203 E8 [00000000]                   	CALL	_print
   377 00000208 68 0000409A                     	PUSH	16538
   378 0000020D FF B5 FFFFF7C0                  	PUSH	DWORD [-2112+EBP]
   379 00000213 68 00000200                     	PUSH	512
   380 00000218 68 00271F58                     	PUSH	2563928
   381 0000021D E8 [00000000]                   	CALL	_set_segmdesc
   382 00000222 68 00001F58                     	PUSH	8024
   383 00000227 6A 00                           	PUSH	0
   384 00000229 E8 [00000000]                   	CALL	_farcall
   385 0000022E 68 [000000BF]                   	PUSH	LC4
   386 00000233 E8 [00000000]                   	CALL	_print
   387 00000238 83 C4 20                        	ADD	ESP,32
   388 0000023B 68 [000000F4]                   	PUSH	LC11
   389 00000240 E9 FFFFFF53                     	JMP	L50
   390 00000245                                 L53:
   391 00000245 85 DB                           	TEST	EBX,EBX
   392 00000247 0F 84 FFFFFEEF                  	JE	L21
   393 0000024D 68 [00000101]                   	PUSH	LC5
   394 00000252 C6 84 1D FFFFF7C4 00            	MOV	BYTE [-2108+EBP+EBX*1],0
   395 0000025A 4B                              	DEC	EBX
   396 0000025B E8 [00000000]                   	CALL	_print
   397 00000260 E9 FFFFFED6                     	JMP	L49
   398 00000265                                 L44:
   399 00000265 C6 84 1D FFFFF7C4 00            	MOV	BYTE [-2108+EBP+EBX*1],0
   400 0000026D E9 FFFFFED0                     	JMP	L20
   401 00000272                                 L52:
   402 00000272 8B 95 FFFFF7BC                  	MOV	EDX,DWORD [-2116+EBP]
   403 00000278 68 [00000101]                   	PUSH	LC5
   404 0000027D C7 84 95 FFFFF7E4 00000000      	MOV	DWORD [-2076+EBP+EDX*4],0
   405 00000288 E9 FFFFFDCA                     	JMP	L46
   406 0000028D                                 L43:
   407 0000028D 8D 45 E4                        	LEA	EAX,DWORD [-28+EBP]
   408 00000290 50                              	PUSH	EAX
   409 00000291 C6 45 E5 30                     	MOV	BYTE [-27+EBP],48
   410 00000295 C6 45 E6 00                     	MOV	BYTE [-26+EBP],0
   411 00000299 E8 0000004C                     	CALL	_HEX2INT
   412 0000029E 8B 95 FFFFF7BC                  	MOV	EDX,DWORD [-2116+EBP]
   413 000002A4 89 84 95 FFFFF7E4               	MOV	DWORD [-2076+EBP+EDX*4],EAX
   414 000002AB 42                              	INC	EDX
   415 000002AC 89 95 FFFFF7BC                  	MOV	DWORD [-2116+EBP],EDX
   416 000002B2 E9 FFFFFEE6                     	JMP	L48
   417 000002B7                                 L51:
   418 000002B7 83 BD FFFFF7BC 00               	CMP	DWORD [-2116+EBP],0
   419 000002BE 0F 8E FFFFFDCB                  	JLE	L10
   420 000002C4 FF 8D FFFFF7BC                  	DEC	DWORD [-2116+EBP]
   421 000002CA 68 [00000103]                   	PUSH	LC3
   422 000002CF 8B 85 FFFFF7BC                  	MOV	EAX,DWORD [-2116+EBP]
   423 000002D5 C7 84 85 FFFFF7E4 00000000      	MOV	DWORD [-2076+EBP+EAX*4],0
   424 000002E0 E8 [00000000]                   	CALL	_print
   425 000002E5 E9 FFFFFDA4                     	JMP	L47
   426 000002EA                                 	GLOBAL	_HEX2INT
   427 000002EA                                 _HEX2INT:
   428 000002EA 55                              	PUSH	EBP
   429 000002EB 89 E5                           	MOV	EBP,ESP
   430 000002ED 50                              	PUSH	EAX
   431 000002EE 6A 10                           	PUSH	16
   432 000002F0 8D 45 FC                        	LEA	EAX,DWORD [-4+EBP]
   433 000002F3 50                              	PUSH	EAX
   434 000002F4 FF 75 08                        	PUSH	DWORD [8+EBP]
   435 000002F7 E8 [00000000]                   	CALL	_strtol
   436 000002FC C9                              	LEAVE
   437 000002FD C3                              	RET
